<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Navigation AR</title>
    <style>
        #overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #arrow {
            width: 50px;
            height: 50px;
            transform-origin: center;
            transition: transform 0.1s ease;
        }
        #video {
            width: 100%;
            height: 100%;
            transform: scaleX(-1); /* Mirror the video for correct camera view */
        }
    </style>
</head>
<body>
<video id="video" autoplay playsinline></video>
<div id="overlay">
    <img id="arrow" src="arrow-icon.png" alt="Arrow" />
</div>

<script>
    // Start camera
    function startCamera() {
        navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" }
        }).then((stream) => {
            const videoElement = document.querySelector("#video");
            videoElement.srcObject = stream;
        }).catch((error) => {
            console.error("Camera not accessible:", error);
        });
    }

    // Get current position
    function getCurrentLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                console.log(`Current Position: Latitude: ${latitude}, Longitude: ${longitude}`);
            });
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }

    // Device orientation
    let compassHeading = 0;
    window.addEventListener('deviceorientation', function(event) {
        compassHeading = event.alpha;
        updateArrowDirection(targetHeading);
    });

    // Update the arrow direction based on the calculated target heading
    function updateArrowDirection(targetHeading) {
        const arrow = document.querySelector("#arrow");
        const angleToRotate = targetHeading - compassHeading;
        arrow.style.transform = `rotate(${angleToRotate}deg)`;
    }

    // Example of calling all functions to start the app
    startCamera();
    getCurrentLocation();
</script>
</body>
</html>
